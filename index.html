<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Dreamcatcher</title>
    <link rel="stylesheet" href="base.css">

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.25.3/moment.min.js"
      integrity="sha256-C66CaAImteEKZPYvgng9j10J/45e9sAuZyfPYCwp4gE="
      crossorigin="anonymous">
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js"
      integrity="sha256-oI+elz+sIm+jpn8F/qEspKoKveTc5uKeFHNNVexe6d8="
      crossorigin="anonymous">
    </script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.3.0/frappe-gantt.min.js"
      integrity="sha256-YA6lue6HOUrphxAbwHtvGF84CE76RcfTyBYvlEU3u6U="
      crossorigin="anonymous">
    </script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.3.0/frappe-gantt.css"
      integrity="sha256-m2zScNAG4lg2ENuIJ2CStnLf9YK0KMAkuZly2YSz8B0="
      crossorigin="anonymous" />
</head>

<body>

  <section class="main">

    <div class="chart_and_controls">
      <div class="gantt-container">
        <svg id="gantt"></svg>
      </div>

      <div class="controls">
        <select onchange="change_gantt_view(this.value);">
          <option value="Day">Day</option>
          <option selected value="Week">Week</option>
          <option value="Month">Month</option>
        </select>

        <button onclick="add_task();">New Task</button>
      </div>
    </div>

    <div class="task_properties">
      <div>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name">
      </div>
      <div>
        <label for="start_date">Start Date:</label>
        <input type="date" id="description_start_date" name="start_date">
      </div>
      <div>
        <label for="end_date">End Date:</label>
        <input type="date" id="description_end_date" name="end_date">
      </div>
      <div>
        <input type="submit" value="Update Task">
      </div>
      <hr>
      <div class="task_description">
        <!-- todo: use css to fill to bottom -->
        <textarea rows="15"> Description </textarea>
      </div>
    </div>
  </section>

  <script>
    var tasks = [
        {
            id: '1',
            name: 'Redesign website',
            start: '2020-03-01',
            end: '2020-03-12'
        }
    ];

    var gantt = new Gantt("#gantt", tasks, {
        view_modes: ['Day', 'Week', 'Month'],
        view_mode: 'Week'
    });

    function change_gantt_view(view_mode) {
        gantt.change_view_mode(view_mode);
    }

    function add_task() {
        var tasks = gantt.tasks;

        //todo: use momentjs
        var today = new Date();
        var end_date = new Date();
        end_date.setDate(today.getDate() + 7);

        var new_task = {
            id: '1',
            name: 'Redesign website',
            start: today,
            end: end_date
        };

        tasks.push(new_task);
        gantt.refresh(tasks);
    }
  </script>

</body>
</html>
